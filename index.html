<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vocabulary Player</title>
  <style>
    button {
      font-size: 20px;
      padding: 15px 30px;
      margin: 10px;
      cursor: pointer;
      background-color: #333333;
      color: white;
      border: none;
      border-radius: 5px;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #555555;
    }

    .word-list {
      display: flex;
      flex-direction: column;
      max-height: 300px;
      overflow-y: auto;
    }

    .word-item {
      margin: 5px 0;
      cursor: pointer;
    }

    .audio-player {
      display: flex;
      flex-direction: column;
      margin-top: 20px;
    }

    .audio-player audio {
      margin-bottom: 10px;
    }

    .meaning-container {
      margin-top: 20px;
    }

    .meaning-container button {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Click a Letter to See Words</h1>

  <!-- A to Z Buttons -->
  <div id="alphabet-buttons">
    <button onclick="showWords('A')">A</button>
    <button onclick="showWords('B')">B</button>
    <button onclick="showWords('C')">C</button>
    <!-- Add more buttons for other letters -->
  </div>

  <!-- Word List -->
  <div id="word-list" class="word-list"></div>

  <div id="word-details" class="audio-player"></div>

  <script>
    // Fetch and parse the Excel file via the URL
    const excelFileURL = "https://github.com/BoydYang-Designer/English-vocabulary/raw/refs/heads/main/Z_total_words.xlsx";
    let wordsData = [];

    // Load the Excel file and parse it (This part would normally use a library like SheetJS or a server-side solution)
    // For simplicity, we assume the data is available as a JSON array with the following structure
    fetch(excelFileURL)
      .then(response => response.arrayBuffer())
      .then(data => {
        // Use a library like SheetJS to read the Excel data into wordsData
        // Here we assume wordsData is an array of objects with relevant columns like:
        // wordsData = [{ "Words": "abusive", "pronunciation_1": "abusive.mp3", "pronunciation_2": "abusive_sentence.mp3", "traditional_Chinese": "虐待的，辱罵的", "English_meaning": "As an Adjective..." }, ...];
      })
      .catch(error => console.error("Error loading the Excel file:", error));

    // Function to show words starting with a given letter
    function showWords(letter) {
      const filteredWords = wordsData.filter(word => word.Words.charAt(0).toUpperCase() === letter);
      const wordListElement = document.getElementById('word-list');
      wordListElement.innerHTML = ''; // Clear the current list
      filteredWords.forEach(word => {
        const wordItem = document.createElement('div');
        wordItem.classList.add('word-item');
        wordItem.textContent = word.Words;
        wordItem.onclick = () => showWordDetails(word);
        wordListElement.appendChild(wordItem);
      });
    }

    // Function to show word details when clicked
    function showWordDetails(word) {
      const detailsElement = document.getElementById('word-details');
      detailsElement.innerHTML = ''; // Clear previous details

      // Play pronunciation audio
      const audioElement = document.createElement('audio');
      audioElement.controls = true;
      audioElement.src = `audio_files/${word.pronunciation_1}`;
      detailsElement.appendChild(audioElement);

      // Show traditional Chinese translation
      const chineseText = document.createElement('p');
      chineseText.textContent = `Traditional Chinese: ${word.traditional_Chinese}`;
      detailsElement.appendChild(chineseText);

      // English meaning button
      const meaningButton = document.createElement('button');
      meaningButton.textContent = "English Meaning";
      meaningButton.onclick = () => showEnglishMeaning(word);
      detailsElement.appendChild(meaningButton);
    }

    // Function to show the English meaning of the word
    function showEnglishMeaning(word) {
      const detailsElement = document.getElementById('word-details');
      
      const meaningText = document.createElement('p');
      meaningText.textContent = word.English_meaning;
      detailsElement.appendChild(meaningText);

      // Play sentence audio
      const sentenceAudio = document.createElement('audio');
      sentenceAudio.controls = true;
      sentenceAudio.src = `audio_files/${word.pronunciation_2}`;
      detailsElement.appendChild(sentenceAudio);
    }
  </script>
</body>
</html>
