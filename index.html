<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boyd Vocabulary</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Boyd Vocabulary</h1>
<div id="searchContainer" style="text-align: center; margin-bottom: 15px;">
    <input type="text" id="searchInput" placeholder="è¼¸å…¥å–®å­—æœå°‹..." oninput="filterWords()" style="padding: 8px; width: 200px;">
</div>
<div class="alphabet-container">
    <script>
        document.write("ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(l => 
            `<button class='letter-btn' onclick='showWords("letter", "${l.toLowerCase()}")'>${l}</button>`
        ).join(" "));
    </script>
</div>
<div class="category-container" id="categoryButtons"></div>
<div class="level-container" id="levelButtons"></div>
<div class="container">
    <div id="wordList" class="word-list">
        <button class="button back-button" onclick="backToFirstLayer()">Back</button>
        <div id="wordItems"></div>
    </div>
    <div id="wordDetails" class="details">
        <div id="searchInDetails" style="text-align: center; margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
            <input type="text" id="searchInputDetails" placeholder="è¼¸å…¥å–®å­—æœå°‹..." oninput="filterWordsInDetails()" style="font-size: 16px; padding: 5px; width: 200px;">
            <button id="bButton" class="button">B</button>
        </div>
        <div id="searchResultsDetails" style="max-height: 200px; overflow-y: auto; text-align: left;"></div>
        <button class="button" onclick="backToWordList()">Back</button>

        <!-- 4ï¸âƒ£ è‹±æ–‡è§£é‡‹å€å¡Š -->
        <div id="phoneticContainer"></div>
        <div id="chineseContainer"></div>
        <div id="meaningContainer"></div>

        <!-- 3ï¸âƒ£ æ’­æ”¾æ§åˆ¶æŒ‰éˆ•ï¼ˆæ”¾åœ¨è‹±æ–‡è§£é‡‹ä¸‹æ–¹ï¼‰ -->
        <div class="audio-controls-wrapper">
            <div class="audio-controls">
            <button class="audio-btn" id="playAudioBtn">
                <img src="https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Svg/play.svg" 
                     alt="Play" width="24" height="24" />
            </button>
            <button class="audio-btn" onclick="adjustAudioTime(-5)">
                <img src="https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Svg/rewind.svg" 
                     alt="Rewind" width="24" height="24" />
            </button>
            <button class="audio-btn" id="pauseResumeBtn" onclick="togglePauseAudio(this)">
                <img src="https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Svg/pause.svg" 
                     alt="Pause" width="24" height="24" />
            </button>
            <button class="audio-btn" onclick="adjustAudioTime(5)">
                <img src="https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Svg/fast-forward.svg" 
                     alt="Fast Forward" width="24" height="24" />
            </button>
        </div>

        <!-- 2ï¸âƒ£ ç­†è¨˜æŒ‰éˆ• -->
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <h3>ç­†è¨˜</h3>
            <div>
                <button onclick="clearAllNotes()" id="clearNoteButton" class="note-button">
                    Deletenote
                </button>
                <button onclick="saveNote()" id="saveNoteButton" class="note-button">
                    Savenote
                </button>
            </div>
        </div>

        <!-- 1ï¸âƒ£ ç­†è¨˜å…§å®¹ï¼ˆæ”¾åœ¨æœ€ä¸‹æ–¹ï¼‰ -->
        <div id="noteContainer">
            <textarea id="wordNote" placeholder="è¼¸å…¥ç­†è¨˜..." style="width: 100%; height: 100px;"></textarea>
            <p id="savedNote"></p>
        </div>
    </div>
</div>

    <script>
let historyStack = []; // è¨˜éŒ„æ‰€æœ‰æ­·å²ç‹€æ…‹
let wordsData = [];
let sentenceAudio = new Audio();
let lastWordListType = ""; // è¨˜éŒ„é€²å…¥å–®å­—åˆ—è¡¨çš„æ–¹å¼
let lastWordListValue = ""; // è¨˜éŒ„å­—æ¯æˆ–åˆ†é¡å€¼

document.addEventListener("DOMContentLoaded", function () {
    fetch("https://boydyang-designer.github.io/English-vocabulary/Z_total_words.json")
        .then(res => res.json())
        .then(data => {
            wordsData = data["New Words"] || [];
            console.log("âœ… JSON è¼‰å…¥æˆåŠŸ:", wordsData);
            
            // ç¢ºä¿åˆ†é¡å’Œç­‰ç´šæŒ‰éˆ•é¡¯ç¤º
            setTimeout(() => {
                createCategoryButtons();
                createLevelButtons();
            }, 500);
        })
        .catch(err => {
            console.error("âŒ è®€å– JSON å¤±æ•—:", err);
        })
        .finally(() => {
            // **ç¢ºä¿ "B" æŒ‰éˆ•åœ¨ DOM åŠ è¼‰å¾Œæ‰åˆå§‹åŒ–**
            setTimeout(() => {
                let bButton = document.getElementById("bButton");
                if (bButton) {
                    bButton.disabled = true; // ç¦ç”¨æŒ‰éµ
                    bButton.style.backgroundColor = "#ccc"; // è¨­å®šæœªå•Ÿå‹•é¡è‰²
                    bButton.addEventListener("click", backToPrevious); // ç¶å®š "B" æŒ‰éµé»æ“Šäº‹ä»¶
                    console.log("ğŸ”µ 'B' æŒ‰éˆ•å·²åˆå§‹åŒ–");
                } else {
                    console.error("âŒ ç„¡æ³•æ‰¾åˆ° 'B' æŒ‰éˆ•ï¼Œè«‹ç¢ºèª HTML æ˜¯å¦æ­£ç¢º");
                }
            }, 300); // **å»¶é² 300ms ç¢ºä¿ DOM åŠ è¼‰å®Œæˆ**
        });
});


function navigateTo(state) {
    // **é¿å…é‡è¤‡å­˜å…¥ç›¸åŒçš„å–®å­—**
    if (historyStack.length === 0 || historyStack[historyStack.length - 1].word !== state.word) {
        historyStack.push(state);
    }

    // **é™åˆ¶æœ€å¤§è¨˜æ†¶æ•¸é‡ï¼Œé¿å…ç„¡é™å¢é•·**
    if (historyStack.length > 10) { 
        historyStack.shift(); // åªä¿ç•™æœ€è¿‘ 10 å€‹è¨˜éŒ„
    }

    console.log("ğŸ“Œ æ–°å¢åˆ°æ­·å²ç´€éŒ„ï¼š", historyStack);
}



function filterWords() {
    let input = document.getElementById("searchInput").value.toLowerCase();

    // ç¢ºä¿ wordsData æ­£ç¢ºè¼‰å…¥
    if (!wordsData || wordsData.length === 0) {
        console.error("âŒ wordsData ç‚ºç©ºï¼Œè«‹ç¢ºèª JSON æ˜¯å¦æˆåŠŸè¼‰å…¥");
        return;
    }

    // ğŸ” æ¸¬è©¦ JSON çµæ§‹ï¼Œç¢ºèªå–®å­—çš„ key åç¨±
    console.log("ğŸ” æ¸¬è©¦ wordsData çµæ§‹:", wordsData[0]);

    // å˜—è©¦ä¸åŒçš„éµåä¾†ç²å–å–®å­—ï¼Œç¢ºä¿å–å¾—æ­£ç¢ºçš„è³‡æ–™
    let filtered = wordsData.filter(w => {
        let word = w.Words || w.word || w["å–®å­—"] || "";  // ç¢ºä¿å–åˆ°å–®å­—
        return word.toLowerCase().startsWith(input);
    });

    let searchResults = document.getElementById("searchResults");
    if (!searchResults) {
        searchResults = document.createElement("div");
        searchResults.id = "searchResults";
        document.getElementById("searchContainer").appendChild(searchResults);
    }

    if (input === "") {
        searchResults.innerHTML = "";
        return;
    }

    searchResults.innerHTML = filtered.length > 0 
    ? filtered.map((w, index) => {
        let word = w.Words || w.word || w["å–®å­—"] || ""; 
        return `<p class='word-item' data-index='${index}'>${word}</p>`;
    }).join("")
    : "<pâš ï¸ æ²’æœ‰ç¬¦åˆçš„å–®å­—</p>";

// é‡æ–°ç¶å®šé»æ“Šäº‹ä»¶ï¼Œç¢ºä¿ showDetails æ­£å¸¸é‹ä½œ
document.querySelectorAll('.word-item').forEach((item, index) => {
    item.addEventListener("click", function() {
        showDetails(filtered[index]); // âœ… é€™æ¨£æ‰èƒ½æ­£ç¢ºå‚³å…¥ word ç‰©ä»¶
    });
});


}

function filterWordsInDetails() {
    let input = document.getElementById("searchInputDetails").value.toLowerCase();
    let searchResults = document.getElementById("searchResultsDetails");

    if (!wordsData || wordsData.length === 0) {
        console.error("âŒ wordsData æœªåŠ è¼‰");
        return;
    }

    if (!searchResults) return;

    if (input === "") {
        searchResults.innerHTML = "";
        return;
    }

    let filtered = wordsData.filter(w => {
        let word = w.Words || w.word || w["å–®å­—"] || "";  
        return word.toLowerCase().startsWith(input);
    });

    searchResults.innerHTML = "";
    
    if (filtered.length === 0) {
        searchResults.innerHTML = "<p>âš ï¸ æ²’æœ‰ç¬¦åˆçš„å–®å­—</p>";
        return;
    }

    filtered.forEach((wordObj, index) => {
        let word = wordObj.Words || wordObj.word || wordObj["å–®å­—"] || "";  
        let item = document.createElement("p");
        item.className = "word-item";
        item.textContent = word;
        item.addEventListener("click", function() {
            showDetails(wordObj); // âœ… ç¢ºä¿æ­£ç¢ºå‚³é word ç‰©ä»¶
        });
        searchResults.appendChild(item);
    });
}

function createCategoryButtons() {
    if (!wordsData || !Array.isArray(wordsData)) return;
    let categories = [...new Set(wordsData.map(w => w["åˆ†é¡"] || "æœªåˆ†é¡"))];
    document.getElementById("categoryButtons").innerHTML = categories
        .map(c => `<button class='letter-btn' onclick='showWords("category", "${c}")'>${c}</button>`)
        .join(" ");
}

function createLevelButtons() {
    if (!wordsData || !Array.isArray(wordsData)) {
        console.error("âŒ ç­‰ç´šæŒ‰éˆ•ç”Ÿæˆå¤±æ•—ï¼ŒwordsData ç‚ºç©º");
        return;
    }
    let levels = [...new Set(wordsData.map(w => w["ç­‰ç´š"] || "æœªåˆ†é¡"))];
    console.log("ğŸ“Œ ç”Ÿæˆç­‰ç´šæŒ‰éˆ•:", levels);

    document.getElementById("levelButtons").innerHTML = levels
        .map(l => `<button class='letter-btn' onclick='showWords("level", "${l}")'>${l}</button>`)
        .join(" ");
}
        
function showWords(type, value) {
    console.log("ğŸ“Œ é»æ“Šåˆ†é¡/ç­‰ç´š/A-Z æŒ‰éˆ•:", type, value);

    navigateTo({ page: "wordList", type: type, value: value });
    lastWordListType = type;
    lastWordListValue = value;

    document.getElementById("searchContainer").style.display = "none";
    let listContainer = document.getElementById("wordList");
    let wordItems = document.getElementById("wordItems");
    wordItems.innerHTML = "";

    if (!wordsData || wordsData.length === 0) {
        console.error("âŒ wordsData æœªåŠ è¼‰æˆ–ç‚ºç©º");
        return;
    }

    let filteredWords = wordsData.filter(w => {
        let word = w.Words || w.word || w["å–®å­—"];
        let category = w["åˆ†é¡"] || "æœªåˆ†é¡";
        let level = w["ç­‰ç´š"] || "æœªåˆ†é¡";

        if (type === "letter") {
            return word ? word.toLowerCase().startsWith(value.toLowerCase()) : false;
        } else if (type === "category") {
            return category === value;
        } else if (type === "level") {
            return level === value;
        }
        return false;
    });

    if (filteredWords.length === 0) {
        wordItems.innerHTML = "<p>âš ï¸ æ²’æœ‰ç¬¦åˆçš„å–®å­—</p>";
    } else {
        filteredWords.forEach(word => {
            let item = document.createElement('p');
            item.textContent = word.Words || word.word || word["å–®å­—"];
            item.className = 'word-item';
            item.onclick = function () { showDetails(word); };
            wordItems.appendChild(item);
        });
    }

    listContainer.style.display = "block";
    document.getElementById("wordDetails").style.display = "none";
    document.querySelector('.alphabet-container').style.display = "none";
    document.querySelector('.category-container').style.display = "none";
    document.querySelector('.level-container').style.display = "none";
}


function backToFirstLayer() {
    document.getElementById("searchContainer").style.display = "block"; // é¡¯ç¤ºæœå°‹æ¡†
    document.getElementById("wordList").style.display = "none"; // éš±è—å–®å­—åˆ—è¡¨
    document.getElementById("wordDetails").style.display = "none"; // éš±è—è©³ç´°å…§å®¹
    document.querySelector('.alphabet-container').style.display = "block"; 
    document.querySelector('.category-container').style.display = "block"; 
    document.querySelector('.level-container').style.display = "block"; 

    // **é¡¯ç¤ºæœå°‹çµæœï¼ˆä½†ä¸æ¸…ç©ºï¼‰**
    let searchResults = document.getElementById("searchResults");
    if (searchResults) {
        searchResults.style.display = "block"; // **æ¢å¾©é¡¯ç¤ºæœå°‹çµæœ**
    }

    // **æ¸…ç©ºå–®å­—åˆ—è¡¨**
    document.getElementById("wordItems").innerHTML = ""; 

    // **æ¸…ç©ºæ­·å²ç´€éŒ„**
    historyStack = [];
    lastWordListType = "";
    lastWordListValue = "";
}


function showDetails(word) {
    let searchInput = document.getElementById("searchInputDetails").value.trim();
    let bButton = document.getElementById("bButton");

    // **åªæœ‰ç•¶ä½¿ç”¨äº†ç¬¬ä¸‰å±¤æœå°‹æ¡†æ™‚ï¼Œæ‰å•Ÿå‹• "B" æŒ‰éµ**
    if (searchInput !== "") {
        bButton.disabled = false; // å•Ÿå‹•æŒ‰éµ
        bButton.style.backgroundColor = "#6c757d"; // è®Šè‰²
    }

    // **ç¢ºä¿æ¯æ¬¡é€²å…¥æ–°å–®å­—éƒ½è¨˜éŒ„åˆ°æ­·å²**
    navigateTo({ page: "wordDetails", word: word });

    // **é¡¯ç¤ºå–®å­—è©³æƒ…**
    document.getElementById("searchContainer").style.display = "none";
    document.getElementById("wordList").style.display = "none";
    document.getElementById("wordDetails").style.display = "block";
    document.querySelector(".alphabet-container").style.display = "none";
    document.querySelector(".category-container").style.display = "none";
    document.querySelector(".level-container").style.display = "none";

    document.getElementById("searchInputDetails").value = "";
    document.getElementById("searchResultsDetails").innerHTML = "";


    // âœ… **ç¢ºä¿ `.audio-controls` é¡¯ç¤º**
    let audioControls = document.querySelector(".audio-controls");
    if (audioControls) {
        audioControls.style.display = "flex"; // é¡¯ç¤ºæ’­æ”¾æŒ‰éˆ•
    } else {
        console.warn("âš ï¸ æ‰¾ä¸åˆ° `.audio-controls`ï¼Œè«‹ç¢ºèª HTML æ˜¯å¦åŒ…å«æ­¤å…ƒç´ ï¼");
    }

    // âœ… **ç¢ºä¿ `playAudioBtn` æ›´æ–°éŸ³æª”**
    let playButton = document.getElementById("playAudioBtn");
    if (playButton) {
        let audioFile = `${encodeURIComponent(word.Words)} - sentence.mp3`;
        playButton.setAttribute("onclick", `playSentenceAudio("${audioFile}")`);
        console.log(`ğŸ”Š æ’­æ”¾æŒ‰éˆ•æ›´æ–°ï¼š${audioFile}`);
    } else {
        console.warn("âš ï¸ æ‰¾ä¸åˆ° `#playAudioBtn` æŒ‰éˆ•ï¼");
    }

    // âœ… **éŸ³æ¨™è™•ç†ï¼ˆè€ƒæ…®ç„¡éŸ³æ¨™çš„æƒ…æ³ï¼‰**
    let phonetics = `<div class="phonetics-container" style="display: flex; align-items: center; gap: 10px;">
    <div id="wordTitle" style="font-size: 20px; font-weight: bold;">${word.Words}</div>`;

    if (word["pronunciation-1"] || word["pronunciation-2"]) {
        if (word["pronunciation-1"]) {
            phonetics += `<button class='button' onclick='playAudio("${encodeURIComponent(word.Words)}.mp3")'>${word["pronunciation-1"]}</button>`;
        }
        if (word["pronunciation-2"]) {
            phonetics += `<button class='button' onclick='playAudio("${encodeURIComponent(word.Words)} 2.mp3")'>${word["pronunciation-2"]}</button>`;
        }
    } else {
        phonetics += `<p style="color: gray;">No pronunciation available</p>`;
    }
    phonetics += `</div>`;

    // âœ… **ä¸­æ–‡è§£é‡‹æ ¼å¼åŒ–**
    let formattedChinese = word["traditional Chinese"]
        .replace(/(\d+)\./g, "<br><strong>$1.</strong> ");
    let chinese = `<div>${formattedChinese}</div>`;

    // âœ… **è‹±æ–‡è§£é‡‹æ ¼å¼åŒ–**
    let formattedMeaning = word["English meaning"]
        .replace(/Summary:/g, "<h3>Summary:</h3>")  
        .replace(/Related Words:/g, "<h3>Related Words:</h3>") 
        .replace(/Antonyms:/g, "<h3>Antonyms:</h3>")
        .replace(/\n1\./g, "<h3>1.</h3><p>")  
        .replace(/\n2\./g, "<h3>2.</h3><p>")  
        .replace(/\n3\./g, "<h3>3.</h3><p>")  
        .replace(/\nE\.g\./g, "</p><p><strong>Example:</strong>")  
        .replace(/\n/g, "<br>");

    let meaning = `<p>${formattedMeaning}</p>`;

    // âœ… **è¨­å®šå…§å®¹åˆ°å°æ‡‰çš„å€å¡Š**
    document.getElementById("phoneticContainer").innerHTML = phonetics;
    document.getElementById("chineseContainer").innerHTML = chinese;
    document.getElementById("meaningContainer").innerHTML = meaning;

    // âœ… **ç¢ºä¿ç­†è¨˜å…§å®¹é¡¯ç¤º**
    displayNote();
}


function backToWordList() {
    if (lastWordListType === "search") {
        // å¦‚æœä¾†è‡ªæœå°‹çµæœï¼Œå›åˆ°ç¬¬ä¸€å±¤ä¸¦é¡¯ç¤ºæœå°‹æ¡†
        document.getElementById("searchContainer").style.display = "block";
        document.getElementById("wordList").style.display = "none";
        document.getElementById("wordDetails").style.display = "none";
        document.querySelector('.alphabet-container').style.display = "block";
        document.querySelector('.category-container').style.display = "block";
        document.querySelector('.level-container').style.display = "block";
    } else if (lastWordListType && lastWordListValue) {
        // å¦‚æœä¾†è‡ªå–®å­—åˆ—è¡¨ï¼Œå›åˆ°ç¬¬äºŒå±¤
        showWords(lastWordListType, lastWordListValue);
    } else {
        console.error("âŒ ç„¡æ³•è¿”å›ï¼ŒlastWordListType ç‚ºç©ºï¼Œå›åˆ°ç¬¬ä¸€å±¤");
        backToFirstLayer(); // å¦‚æœ `lastWordListType` ç„¡æ•ˆï¼Œå›åˆ°é¦–é 
    }
}

function playAudio(filename) {
    let baseURL = "https://github.com/BoydYang-Designer/English-vocabulary/raw/main/audio_files/";
    new Audio(baseURL + filename).play();
}

function playSentenceAudio(filename) {
    let baseURL = "https://github.com/BoydYang-Designer/English-vocabulary/raw/main/audio_files/";
    sentenceAudio.src = baseURL + filename;
    sentenceAudio.play();
}


function togglePauseAudio(button) {
    if (sentenceAudio.paused || sentenceAudio.ended) {
        sentenceAudio.play();
        button.innerHTML = `
            <img src="https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Svg/pause.svg" alt="Pause" width="24" height="24" />
        `;
    } else {
        sentenceAudio.pause();
        button.innerHTML = `
            <img src="https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Svg/play-circle.svg" alt="Play" width="24" height="24" />
        `;
    }
}

function adjustAudioTime(seconds) {
    sentenceAudio.currentTime = Math.max(0, sentenceAudio.currentTime + seconds);
}

function backToPrevious() {
    if (historyStack.length > 1) {
        historyStack.pop(); // ç§»é™¤ç•¶å‰ç‹€æ…‹
        let previousState = historyStack[historyStack.length - 1]; // å–å¾—ä¸Šä¸€å€‹ç‹€æ…‹

        if (previousState.page === "wordDetails") {
            showDetails(previousState.word); // è¿”å›ä¸Šä¸€å€‹å–®å­—
        }
    }

    // **ç•¶æ­·å²ç´€éŒ„åªå‰© 1 å€‹æ™‚ï¼Œåœç”¨ "B" æŒ‰éµ**
    if (historyStack.length <= 1) {
        let bButton = document.getElementById("bButton");
        bButton.disabled = true;
        bButton.style.backgroundColor = "#ccc"; // å›åˆ°æœªå•Ÿå‹•é¡è‰²
    }

    console.log("ğŸ”™ é»æ“Š B æŒ‰éˆ•å¾Œçš„æ­·å²ç´€éŒ„ï¼š", historyStack);
}




document.querySelectorAll('.back-button').forEach(button => {
    button.addEventListener("click", backToPrevious);
});

window.addEventListener("load", adjustAudioControlsWidth);
window.addEventListener("resize", adjustAudioControlsWidth);

function adjustAudioControlsWidth() {
    let details = document.querySelector(".details");
    let audioControls = document.querySelector(".audio-controls");

    if (details && audioControls) {
        let detailsWidth = details.offsetWidth; // å–å¾— .details çš„å¯¦éš›å¯¬åº¦
        audioControls.style.width = detailsWidth + "px"; // è¨­å®šç›¸åŒçš„å¯¬åº¦
        audioControls.style.maxWidth = detailsWidth + "px"; // é˜²æ­¢è¶…é
    }
}

function saveNote() {
    let word = document.getElementById("wordTitle")?.textContent.trim();
    let note = document.getElementById("wordNote").value.trim();
    let saveButton = document.querySelector("button[onclick='saveNote()']"); // å–å¾—æŒ‰éˆ•

    if (word && word !== "") { 
        localStorage.setItem(`note_${word}`, note); // å­˜å…¥ localStorage
        console.log("âœ… ç­†è¨˜å·²ä¿å­˜:", word, note);

        // âœ… æŒ‰éˆ•é¡¯ç¤ºã€Œå·²ä¿å­˜ã€
        saveButton.textContent = "å·²ä¿å­˜ âœ…";
        saveButton.style.backgroundColor = "#28a745"; // ç¶ è‰²è¡¨ç¤ºæˆåŠŸ

        // âœ… 2 ç§’å¾Œæ¢å¾©åŸæœ¬æ¨£å¼
        setTimeout(() => {
            saveButton.textContent = "ä¿å­˜ç­†è¨˜";
            saveButton.style.backgroundColor = "#007bff";
        }, 2000);
        
        // âœ… åœ¨ç­†è¨˜å€ä¸‹æ–¹é¡¯ç¤ºã€Œç­†è¨˜å·²ä¿å­˜ï¼ã€
        document.getElementById("savedNote").textContent = "âœ… ç­†è¨˜å·²ä¿å­˜ï¼";
        setTimeout(() => document.getElementById("savedNote").textContent = "", 3000);
    } else {
        console.warn("âš ï¸ ç„¡æ³•ä¿å­˜ç­†è¨˜ï¼ŒwordTitle æœªåŠ è¼‰");
    }
}

function clearAllNotes() {
    if (confirm("âš ï¸ ä½ ç¢ºå®šè¦åˆªé™¤æ‰€æœ‰ç­†è¨˜å—ï¼Ÿé€™å€‹å‹•ä½œç„¡æ³•å¾©åŸï¼")) {
        localStorage.clear();
        console.log("âœ… æ‰€æœ‰ç­†è¨˜å·²æ¸…é™¤");
        alert("âœ… æ‰€æœ‰ç­†è¨˜å·²æ¸…é™¤ï¼");
        document.getElementById("wordNote").value = ""; // æ¸…ç©ºç­†è¨˜å€
    }
}

function displayNote() {
    let word = document.getElementById("wordTitle")?.textContent.trim();
    
    if (word && word !== "") {
        let savedNote = localStorage.getItem(`note_${word}`) || ""; // è®€å–ç­†è¨˜
        document.getElementById("wordNote").value = savedNote; // è¨­å®šå› textarea
        console.log("ğŸ“Œ è¼‰å…¥ç­†è¨˜:", word, savedNote);
    } else {
        console.warn("âš ï¸ ç„¡æ³•è¼‰å…¥ç­†è¨˜ï¼ŒwordTitle æœªåŠ è¼‰");
    }
}

// **ç¢ºä¿åœ¨é é¢è¼‰å…¥æ™‚ï¼Œè‡ªå‹•è¼‰å…¥ç­†è¨˜**
document.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
        if (document.getElementById("wordTitle")) {
            displayNote();
        }
    }, 500); // å»¶é² 500msï¼Œç¢ºä¿ `wordTitle` å·²è¼‰å…¥
});


</script>
</body>
</html>
