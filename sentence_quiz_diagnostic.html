<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥å­æ¸¬é©—è¨ºæ–·å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .info-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .success {
            color: #28a745;
            font-weight: bold;
        }
        
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        .category-list {
            max-height: 300px;
            overflow-y: auto;
            background: white;
            padding: 10px;
            border-radius: 5px;
        }
        
        .category-item {
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” å¥å­æ¸¬é©—è¨ºæ–·å·¥å…·</h1>
        
        <div class="section">
            <h2>ğŸ“Š æ­¥é©Ÿ 1: è¼‰å…¥è³‡æ–™</h2>
            <button onclick="loadData()">è¼‰å…¥ sentence.json</button>
            <div id="loadStatus" class="info-box" style="margin-top: 10px;"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ“‹ æ­¥é©Ÿ 2: æŸ¥çœ‹è³‡æ–™çµ±è¨ˆ</h2>
            <div id="dataStats" class="info-box"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ·ï¸ æ­¥é©Ÿ 3: æŸ¥çœ‹åˆ†é¡åˆ—è¡¨</h2>
            <div id="categoryList" class="category-list"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ¯ æ­¥é©Ÿ 4: æ¸¬è©¦ç¯©é¸åŠŸèƒ½</h2>
            <button onclick="testNoFilter()">æ¸¬è©¦:ä¸é¸æ“‡ä»»ä½•æ¢ä»¶</button>
            <button onclick="testLevelFilter()">æ¸¬è©¦:åªé¸B2ç­‰ç´š</button>
            <button onclick="testCategoryFilter()">æ¸¬è©¦:é¸æ“‡ä¸»åˆ†é¡</button>
            <div id="filterResult" class="info-box" style="margin-top: 10px;"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ› æ­¥é©Ÿ 5: æŸ¥çœ‹å®Œæ•´æ—¥èªŒ</h2>
            <div id="debugLog"></div>
        </div>
    </div>

    <script>
        let sentenceData = [];
        let logs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logs.push(logEntry);
            console.log(logEntry);
            updateDebugLog();
        }
        
        function updateDebugLog() {
            const debugLog = document.getElementById('debugLog');
            debugLog.innerHTML = '<pre>' + logs.join('\n') + '</pre>';
        }
        
        // æå–ä¸­æ–‡åç¨±
        function extractChineseName(fullName) {
            if (!fullName) return "æœªåˆ†é¡";
            const match = fullName.match(/ï¼ˆ([^ï¼‰]+)ï¼‰/);
            if (match && match[1]) {
                return match[1];
            }
            return fullName;
        }
        
        // æå–è‹±æ–‡åç¨±
        function extractEnglishName(fullName) {
            if (!fullName) return "";
            return fullName.replace(/ï¼ˆ[^ï¼‰]+ï¼‰/g, '').trim();
        }
        
        async function loadData() {
            const statusDiv = document.getElementById('loadStatus');
            statusDiv.innerHTML = '<span class="warning">â³ è¼‰å…¥ä¸­...</span>';
            log('é–‹å§‹è¼‰å…¥ sentence.json');
            
            try {
                const response = await fetch('https://raw.githubusercontent.com/BoydYang-Designer/English-vocabulary/main/Sentence%20file/sentence.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                log(`âœ… JSON è¼‰å…¥æˆåŠŸ`);
                
                if (!data["New Words"] || !Array.isArray(data["New Words"])) {
                    throw new Error('è³‡æ–™æ ¼å¼éŒ¯èª¤');
                }
                
                sentenceData = data["New Words"].filter(item => item.å¥å­ && item.ä¸­æ–‡);
                log(`âœ… ç¯©é¸å¾Œæœ‰ ${sentenceData.length} å€‹æœ‰æ•ˆå¥å­`);
                
                // è™•ç†åˆ†é¡
                sentenceData.forEach(item => {
                    if (typeof item["åˆ†é¡"] === "string") {
                        item["åˆ†é¡"] = [item["åˆ†é¡"]];
                    } else if (!Array.isArray(item["åˆ†é¡"])) {
                        item["åˆ†é¡"] = [];
                    }
                    
                    item.primaryCategoryFull = item["åˆ†é¡"][0] || "æœªåˆ†é¡";
                    item.primaryCategory = extractChineseName(item.primaryCategoryFull);
                    item.primaryCategoryEn = extractEnglishName(item.primaryCategoryFull);
                    item.secondaryCategories = item["åˆ†é¡"].slice(1);
                });
                
                log(`âœ… åˆ†é¡è™•ç†å®Œæˆ`);
                
                statusDiv.innerHTML = `<span class="success">âœ… æˆåŠŸè¼‰å…¥ ${sentenceData.length} å€‹å¥å­</span>`;
                
                showStats();
                showCategories();
                
            } catch (error) {
                log(`âŒ è¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
                statusDiv.innerHTML = `<span class="error">âŒ è¼‰å…¥å¤±æ•—: ${error.message}</span>`;
            }
        }
        
        function showStats() {
            const statsDiv = document.getElementById('dataStats');
            
            // çµ±è¨ˆç­‰ç´š
            const levels = {};
            sentenceData.forEach(item => {
                const level = item.ç­‰ç´š || 'æœªåˆ†é¡';
                levels[level] = (levels[level] || 0) + 1;
            });
            
            // çµ±è¨ˆä¸»åˆ†é¡
            const categories = {};
            sentenceData.forEach(item => {
                const cat = item.primaryCategory;
                categories[cat] = (categories[cat] || 0) + 1;
            });
            
            let html = `
                <div><strong>ç¸½å¥å­æ•¸:</strong> ${sentenceData.length}</div>
                <div><strong>ç­‰ç´šåˆ†å¸ƒ:</strong></div>
                <div style="margin-left: 20px;">
                    ${Object.entries(levels).sort().map(([k,v]) => `${k}: ${v} å€‹`).join('<br>')}
                </div>
                <div style="margin-top: 10px;"><strong>ä¸»åˆ†é¡æ•¸é‡:</strong> ${Object.keys(categories).length} å€‹</div>
            `;
            
            statsDiv.innerHTML = html;
            log(`çµ±è¨ˆå®Œæˆ: ${Object.keys(levels).length} å€‹ç­‰ç´š, ${Object.keys(categories).length} å€‹ä¸»åˆ†é¡`);
        }
        
        function showCategories() {
            const listDiv = document.getElementById('categoryList');
            
            const categories = {};
            sentenceData.forEach(item => {
                const cat = item.primaryCategory;
                categories[cat] = (categories[cat] || 0) + 1;
            });
            
            let html = '<div style="font-weight: bold; margin-bottom: 10px;">æ‰€æœ‰ä¸»åˆ†é¡ (é»æ“ŠæŸ¥çœ‹è©³æƒ…):</div>';
            
            Object.entries(categories).sort((a,b) => b[1] - a[1]).forEach(([cat, count]) => {
                html += `<div class="category-item" onclick="showCategoryDetail('${cat}')">
                    <strong>${cat}</strong>: ${count} å€‹å¥å­
                </div>`;
            });
            
            listDiv.innerHTML = html;
        }
        
        function showCategoryDetail(categoryName) {
            const samples = sentenceData.filter(s => s.primaryCategory === categoryName).slice(0, 3);
            alert(`åˆ†é¡: ${categoryName}\n\nç¯„ä¾‹å¥å­:\n${samples.map(s => `- ${s.Words}: ${s.å¥å­.substring(0, 50)}...`).join('\n')}`);
        }
        
        function testNoFilter() {
            log('æ¸¬è©¦: ä¸é¸æ“‡ä»»ä½•æ¢ä»¶');
            const resultDiv = document.getElementById('filterResult');
            
            if (sentenceData.length === 0) {
                resultDiv.innerHTML = '<span class="error">âŒ è«‹å…ˆè¼‰å…¥è³‡æ–™</span>';
                return;
            }
            
            const filtered = sentenceData.filter(item => {
                return true; // ä¸ç¯©é¸,å…¨éƒ¨é€šé
            });
            
            log(`ç¯©é¸çµæœ: ${filtered.length} å€‹å¥å­`);
            
            if (filtered.length > 0) {
                const samples = filtered.slice(0, 5);
                resultDiv.innerHTML = `
                    <div class="success">âœ… æ¸¬è©¦æˆåŠŸ!</div>
                    <div>æ‰¾åˆ° ${filtered.length} å€‹å¥å­</div>
                    <div style="margin-top: 10px;"><strong>å‰5å€‹å¥å­:</strong></div>
                    ${samples.map(s => `<div style="margin-left: 20px;">- ${s.Words}</div>`).join('')}
                `;
            } else {
                resultDiv.innerHTML = '<span class="error">âŒ æ²’æœ‰æ‰¾åˆ°ä»»ä½•å¥å­</span>';
            }
        }
        
        function testLevelFilter() {
            log('æ¸¬è©¦: åªé¸B2ç­‰ç´š');
            const resultDiv = document.getElementById('filterResult');
            
            if (sentenceData.length === 0) {
                resultDiv.innerHTML = '<span class="error">âŒ è«‹å…ˆè¼‰å…¥è³‡æ–™</span>';
                return;
            }
            
            const filtered = sentenceData.filter(item => {
                return item.ç­‰ç´š === 'B2';
            });
            
            log(`ç¯©é¸çµæœ: ${filtered.length} å€‹B2å¥å­`);
            
            if (filtered.length > 0) {
                const samples = filtered.slice(0, 5);
                resultDiv.innerHTML = `
                    <div class="success">âœ… æ¸¬è©¦æˆåŠŸ!</div>
                    <div>æ‰¾åˆ° ${filtered.length} å€‹ B2 ç­‰ç´šå¥å­</div>
                    <div style="margin-top: 10px;"><strong>å‰5å€‹å¥å­:</strong></div>
                    ${samples.map(s => `<div style="margin-left: 20px;">- ${s.Words}: ${s.ç­‰ç´š}</div>`).join('')}
                `;
            } else {
                resultDiv.innerHTML = '<span class="error">âŒ æ²’æœ‰æ‰¾åˆ° B2 å¥å­</span>';
            }
        }
        
        function testCategoryFilter() {
            log('æ¸¬è©¦: é¸æ“‡ä¸»åˆ†é¡');
            const resultDiv = document.getElementById('filterResult');
            
            if (sentenceData.length === 0) {
                resultDiv.innerHTML = '<span class="error">âŒ è«‹å…ˆè¼‰å…¥è³‡æ–™</span>';
                return;
            }
            
            // æ‰¾å‡ºæœ€å¤šå¥å­çš„åˆ†é¡
            const categories = {};
            sentenceData.forEach(item => {
                const cat = item.primaryCategory;
                categories[cat] = (categories[cat] || 0) + 1;
            });
            
            const topCategory = Object.entries(categories).sort((a,b) => b[1] - a[1])[0][0];
            log(`æ¸¬è©¦åˆ†é¡: ${topCategory}`);
            
            const filtered = sentenceData.filter(item => {
                return item.primaryCategory === topCategory;
            });
            
            log(`ç¯©é¸çµæœ: ${filtered.length} å€‹å¥å­å±¬æ–¼ "${topCategory}"`);
            
            if (filtered.length > 0) {
                const samples = filtered.slice(0, 5);
                resultDiv.innerHTML = `
                    <div class="success">âœ… æ¸¬è©¦æˆåŠŸ!</div>
                    <div>æ¸¬è©¦åˆ†é¡: <strong>${topCategory}</strong></div>
                    <div>æ‰¾åˆ° ${filtered.length} å€‹å¥å­</div>
                    <div style="margin-top: 10px;"><strong>å‰5å€‹å¥å­:</strong></div>
                    ${samples.map(s => `<div style="margin-left: 20px;">- ${s.Words}<br><small style="color: #666;">å®Œæ•´åˆ†é¡: ${s.primaryCategoryFull}</small></div>`).join('')}
                `;
            } else {
                resultDiv.innerHTML = '<span class="error">âŒ æ²’æœ‰æ‰¾åˆ°å¥å­</span>';
            }
        }
    </script>
</body>
</html>
