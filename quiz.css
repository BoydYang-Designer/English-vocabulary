/* ==========================================
   🌍 全域設定 (Global Styles)
========================================== */
html, body {
    overflow-x: hidden; /* 禁止左右滾動 */
    overflow-y: auto;   /* 啟用上下滾動 */
    touch-action: manipulation;
    font-family: Arial, sans-serif;
    background-color: #FDFBF6; /* [大地色] 溫暖的米白背景 */
    margin: 0;
    padding: 0;
}

/* ==========================================
   🏷️ 標題樣式 (Headings)
========================================== */
h1, h2 {
    text-align: center;
    background: linear-gradient(to right, #A1887F, #8D6E63); /* [大地色] 較淺的暖棕色漸層 */
    color: white;
    padding: 15px 0;
    margin: 0;
    font-size: 24px;
}

/* ==========================================
   📦 主要區塊樣式 (Main Sections)
========================================== */
#mainMenu, #quizCategories, #quizArea, #quizResult, #sentenceQuizCategories, #sentenceQuizArea {
    max-width: 100%;
    width: 90%; /* 保證元素不超出螢幕寬度 */
    margin: 10px auto; /* 自動居中 */
    background-color: #fff;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* word-link 按鈕樣式 (繼承下方 .word-link) */
.word-link {
    /* ...樣式由下方 .word-link (Links) 提供... */
}

/* phonetic-btn 按鈕樣式 (繼承下方 .phonetic-btn) */
.phonetic-btn {
     /* ...樣式由下方 .phonetic-btn (Phonetics) 提供... */
}

/* Letter input boxes for sentence word quiz */
.letter-input {
    width: 40px;  /* 您想要的新寬度 */
    height: 40px; /* 您想要的新高度 */
    font-size: 24px; /* 加大字體讓格子看起來更飽滿 */
    padding: 5px;
    border: 1px solid #BCAAA4; /* [大地色] 邊框 */
    border-radius: 5px;
    text-align: center;
    text-transform: lowercase;
    margin: 2px;
    box-sizing: border-box;
}

/* [NEW] Style for incorrect letters in Word Quiz input boxes */
.incorrect-letter-input {
    color: #a8454f !important; /* [大地色] 錯誤/刪除紅 */
    font-weight: bold;
}


/* 手機適配 */
@media (max-width: 600px) {
    .letter-input {
        width: 32px;
        height: 32px;
        font-size: 18px;
    }

    .category-title {
        font-size: 16px;
        margin: 8px 0;
    }
}

/* ==========================================
   🔘 按鈕樣式 (Buttons)
========================================== */
.button-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    width: 100%;
    margin-top: 10px;
}

.button, .back-button, #startFilteredQuizBtn, #startSentenceQuizBtn, #startReorganizeQuizBtn {
    display: block;
    width: 150px;
    height: 50px;
    background-color: #A1887F; /* [大地色] 較淺的主色調 */
    color: white;
    font-size: 18px;
    border-radius: 25px;
    border: none;
    cursor: pointer;
    text-align: center;
    margin: 10px auto;
    font-weight: bold;
    transition: background-color 0.3s ease;
}

.button:hover, .back-button:hover {
    background-color: #8D6E63; /* [大地色] Hover 加深 */
}

#cancelBtn {
    background-color: #a8454f; /* [大地色] 刪除/錯誤紅 */
    color: white;
}

#cancelBtn:hover {
    background-color: #7a3a40; /* [大地色] 刪除/錯誤紅 Hover */
}

#startFilteredQuizBtn, #startSentenceQuizBtn, #startReorganizeQuizBtn, #startRewordQuizBtn {
    background-color: #A1887F; /* [大地色] 統一使用主色調 */
    padding: 10px 20px;
}

#startFilteredQuizBtn:hover, #startSentenceQuizBtn:hover, #startReorganizeQuizBtn:hover, #startRewordQuizBtn:hover {
    background-color: #8D6E63; /* [大地色] Hover 加深 */
}

/* 其他按鈕樣式保持不變 */
.category-button {
    padding: 8px 15px;
    margin: 5px;
    cursor: pointer;
    border: 1px solid #EFEBE9; 
    background: #FFFFFF;
    color: #A1887F; /* [大地色] 較淺的主色調 */
    font-size: 16px; 
    border-radius: 20px;
    transition: all 0.2s ease;
}

.category-button:hover {
    background: #FAFAFA;
    border-color: #A1887F;
}

.category-button.selected {
    background: #A1887F; /* [大地色] 較淺的主色調 */
    color: white;
    border-color: #A1887F;
    transform: scale(1.05);
}

.button-group {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
    width: 390px;
    margin-left: auto; /* 加入這行 */
    margin-right: auto; /* 加入這行 */
    flex-wrap: wrap; /* 允許換行 */
}

.collapsible-header.header-highlight {
    background-color: #FAFAFA; /* [大地色] */
    color: #795548; /* [大地色] */
    font-weight: bold;
    border: 1px solid #A1887F; /* [大地色] */
}

.collapsible-section-wrapper {
    max-width: 100%;
    margin: 15px auto;
    padding: 0 10px;
    box-sizing: border-box;
}

.collapsible-section {
    margin-bottom: 8px;
}

.collapsible-header {
    background-color: #FFFFFF; 
    color: #5D4037; /* [大地色] */
    cursor: pointer;
    padding: 12px 20px;
    width: 100%;
    border: 1px solid #EFEBE9; /* [大地色] */
    text-align: left;
    outline: none;
    font-size: 18px;
    font-weight: bold;
    border-radius: 8px; /* [大地色] 統一圓角 */
    transition: all 0.3s ease; /* [大地色] 統一樣式 */
    position: relative;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05); /* [大地色] 統一樣式 */
}

.collapsible-header:hover {
    background-color: #F5F5F5; /* [大地色] */
    border-color: #BCAAA4; /* [大地色] */
}

.collapsible-header::after {
    content: '\002B'; /* Plus sign */
    color: #A1887F; /* [大地色] */
    font-weight: bold;
    float: right;
    margin-left: 5px;
    transition: transform 0.3s ease;
}

.collapsible-header.active::after {
    content: '\2212'; /* Minus sign */
}

/* ▼▼▼ 更新的程式碼從這裡開始 ▼▼▼ */
.collapsible-content {
    padding: 0 10px; /* 外層 padding 與 index.css 統一 */
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
    background-color: #FAFAFA; /* [大地色] */
    border-radius: 0 0 8px 8px; /* [大地色] */
    border: 1px solid #EFEBE9; /* [大地色] */
    border-top: none; /* [大地色] */
}

/* 新增 button-wrapper 確保內部按鈕排版與 index.css 一致 */
.collapsible-content .button-wrapper {
    padding: 10px 0;
    text-align: center;
}



/* ==========================================
   📑 結果樣式 (Results)
========================================== */
.result-item {
    padding: 10px;
    margin-bottom: 10px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.result-item.correct {
    background-color: #F1F8E9; /* [大地色] 淺成功綠 */
    border-color: #AED581; /* [大地色] 成功綠 */
}

.result-item.wrong {
    background-color: #FFEBEE; /* [大地色] 淺錯誤紅 */
    border-color: #EF9A9A; /* [大地色] 錯誤紅 */
}

.result-item.unanswered {
    background-color: #FFF8E1; /* [大地色] 淺警告黃 */
    border-color: #FFCC80; /* [大地色] 警告黃 */
}

/* ==========================================
   📝 輸入框樣式 (Inputs)
========================================== */
#wordInput {
    display: flex; /* Use flexbox to arrange boxes */
    flex-wrap: wrap; /* Allow wrapping for long words */
    justify-content: center; /* Center the boxes */
    gap: 5px; /* Small gap between boxes */
    width: 100%;
    max-width: 600px; /* Increased max-width for better layout */
    margin: 10px auto; /* Center the container */
}

/* Letter input boxes for word quiz */
.letter-box {
    width: 40px; /* Fixed width for square shape */
    height: 40px; /* Equal height for square shape */
    padding: 5px; /* Reduced padding for balance */
    font-size: 18px; /* Maintain readable font size */
    border: 1px solid #BCAAA4; /* [大地色] Border */
    border-radius: 5px; /* Slight rounding for aesthetics */
    text-align: center; /* Center the letter */
    text-transform: lowercase; /* Ensure lowercase input */
    margin: 2px; /* Small margin between boxes */
    display: inline-flex; /* Use flex to center content */
    align-items: center; /* Vertically center text */
    justify-content: center; /* Horizontally center text */
    box-sizing: border-box; /* Include padding and border in size */
}

/* Non-input boxes (for spaces or hyphens) */
.non-input-box {
    width: 40px; /* Match letter-box size */
    height: 40px; /* Match letter-box size */
    line-height: 40px; /* Center text vertically */
    text-align: center; /* Center text horizontally */
    font-size: 18px; /* Match letter-box font size */
    margin: 2px; /* Match letter-box margin */
    display: inline-flex; /* Match letter-box display */
    align-items: center; /* Match letter-box alignment */
    justify-content: center; /* Match letter-box alignment */
}

/* Mobile adaptation for letter boxes */
@media (max-width: 600px) {
    .letter-box, .non-input-box {
        width: 32px; /* Smaller size for mobile */
        height: 32px; /* Equal height for square shape */
        font-size: 16px; /* Slightly smaller font for mobile */
        padding: 4px; /* Adjusted padding for mobile */
        margin: 1px; /* Smaller margin for mobile */
    }
}

/* Word hint text for word quiz */
#wordHint {
    font-size: 28px; /* Larger font size for better visibility */
    margin: 20px 10px;
    text-align: center;
    letter-spacing: 3px;
    color: #5D4037; /* [大地色] Main text */
    max-width: 90%; /* Prevent overflow */
    word-wrap: break-word; /* Ensure long hints wrap */
}

/* Mobile adaptation for word hint */
@media (max-width: 600px) {
    #wordHint {
        font-size: 18px; /* Slightly smaller for mobile */
        letter-spacing: 2px;
        margin: 15px 5px;
    }
}

/* ==========================================
   🔗 連結樣式 (Links)
========================================== */
.word-link {
    color: #A1887F; /* [大地色] Main action color */
    text-decoration: none;
}

.word-link:hover {
    text-decoration: underline;
}

/* ==========================================
   🎧 音標樣式 (Phonetics)
========================================== */
.phonetic-btn {
    background: none;
    border: none;
    color: #A1887F; /* [大地色] Main action color */
    cursor: pointer;
    font-size: 21px;
    padding: 0;
}

.phonetic-btn:hover {
    text-decoration: underline;
}

/* ==========================================
   📊 進度條樣式 (Progress Bar)
========================================== */
#progressBarContainer {
    margin-bottom: 20px;
    width: 100%;
    background-color: #EFEBE9; /* [大地色] Lightest */
    border-radius: 5px;
    height: 20px;
}

#progressBar {
    height: 100%;
    width: 0%;
    background-color: #A1887F; /* [大地色] Main action */
    border-radius: 5px;
    transition: width 0.3s ease;
}

/* ==========================================
   ⭐ 重要單字標記 (Important Words)
========================================== */
.important-word {
    display: flex;
    align-items: center;
    gap: 5px;
}

.important-checkbox {
    width: 20px;
    height: 20px;
    transform: scale(1.3);
    cursor: pointer;
    border-radius: 6px;
    border: 2px solid #BCAAA4; /* [大地色] */
    appearance: none;
    background-color: white;
    transition: all 0.2s ease-in-out;
}

.important-checkbox:checked {
    background-color: #FFCC80; /* [大地色] Important */
    border-color: #FFA726; /* [大地色] Important */
}

/* ==========================================
   ❗ 錯誤單字列表樣式 (Wrong Words List)
========================================== */
#wrongWordsList {
    max-width: 100%;
    width: 90%;
    margin: 10px auto;
    background-color: #fff;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.wrong-word-item {
    display: flex;
    align-items: center;
    padding: 10px;
    margin-bottom: 10px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    justify-content: space-between;
}

.delete-btn {
    background-color: #a8454f; /* [大地色] Destructive */
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.delete-btn:hover {
    background-color: #7a3a40; /* [大地色] Destructive hover */
}

.delete-btn.selected {
    background-color: #7a3a40;
}

/* ==========================================
   🔄 重組單字區塊樣式 (Word Blocks)
========================================== */
.word-blocks-container {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin: 20px auto;
    justify-content: center;
    max-width: 90%;
}


.subcategory-wrapper {
    max-height: 0; /* 預設收合 */
    overflow: hidden; /* 隱藏超出的內容 */
    transition: max-height 0.3s ease-out; /* 關鍵：加上高度變化的過渡動畫 */
    padding-left: 20px; /* (可選) 增加一些縮排，讓層級更明顯 */
    box-sizing: border-box;
    margin-top: 8px;
    margin-bottom: 5px;
    background-color: #FAFAFA; /* [大地色] */
    border-radius: 5px;
    padding-top: 5px;
    padding-bottom: 5px;
}

.word-block {
    padding: 10px 15px; /* 調整內距，適中大小 */
    background-color: #FFFFFF; /* [大地色] */
    border: 1px solid #BCAAA4; /* [大地色] */
    border-radius: 6px; /* 稍大的圓角，現代感 */
    cursor: pointer;
    user-select: none;
    font-size: 20px; /* 加大字體，增強可讀性 */
    font-weight: 500; /* 中等字重，清晰但不厚重 */
    line-height: 1.4; /* 行高改善文字垂直居中 */
    transition: all 0.2s ease; /* 平滑過渡所有屬性 */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* 輕微陰影，增加立體感 */
    min-width: 50px; /* 確保短詞有足夠寬度 */
    text-align: center; /* 文字居中 */
    color: #5D4037; /* [大地色] Main text */
}

.word-block:hover {
    background-color: #FAFAFA; /* [大地色] */
    border-color: #A1887F; /* [大地色] */
    transform: translateY(-2px); /* 輕微上移，增加互動感 */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15); /* 懸停時陰影加深 */
}

.word-block.selected {
    background-color: #A1887F; /* [大地色] */
    border-color: #8D6E63; /* [大地色] */
    color: white; /* [大地色] */
    opacity: 1; /* 移除透明度，增強可見性 */
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2); /* 選中時更強的陰影 */
}

/* 正確的單字塊 */
.word-block.correct {
    background-color: #F1F8E9; /* [大地色] 淺成功綠 */
    border: 1px solid #AED581; /* [大地色] 成功綠 */
    color: #5D4037;
}

/* 錯誤的單字塊 */
.word-block.incorrect {
    background-color: #FFEBEE; /* [大地色] 淺錯誤紅 */
    border: 3px solid #EF9A9A; /* [大地色] 錯誤紅 */
    color: #5D4037;
}

/* 未填入的占位符 */
.construction-placeholder.unfilled {
    background-color: #FFF8E1; /* [大地色] 淺警告黃 */
    border: 3px solid #EF9A9A; /* [大地色] 錯誤紅 (表示未填) */
    border-radius: 5px; /* 圓角 */
}

/* 重組提示文字 */
#sentenceHint, #reorganizeSentenceHint {
    font-size: 24px; /* 略小字體，與新尺寸協調 */
    margin: 20px 10px;
    text-align: center;
    letter-spacing: 3px;
    color: #5D4037; /* [大地色] */
    max-width: 90%; /* 防止提示文字溢出 */
    word-wrap: break-word; /* 長句子自動換行 */
}

/* 手機適配 */
@media (max-width: 600px) {
    .word-blocks-container {
        gap: 8px; /* 手機上縮小間距 */
        max-width: 95%; /* 更充分利用螢幕 */
    }

    .word-block {
        padding: 8px 12px; /* 手機上稍減內距 */
        font-size: 18px; /* 手機上字體稍小 */
        min-width: 40px; /* 短詞最小寬度 */
        border-radius: 5px; /* 手機上圓角略小 */
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* 手機上陰影更輕 */
    }

    .word-block:hover {
        transform: none; /* 手機上禁用上移效果，減少誤觸 */
    }

    .construction-area {
        min-height: 50px;
        padding: 10px;
        gap: 6px;
        max-width: 95%;
    }

    #sentenceHint, #reorganizeSentenceHint {
        font-size: 20px;
        letter-spacing: 2px;
        margin: 15px 5px;
    }

    #reorganizeWordHint {
        font-size: 24px;
        margin: 20px 10px;
        text-align: center;
        letter-spacing: 3px;
        color: #5D4037; /* [大地色] */
    }
}

/* Reword Quiz 專用字母塊容器 */
#rewordLetterBlocksContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin: 20px auto;
    justify-content: center;
    max-width: 90%;
}

/* Reword Quiz 專用構建區域 */
#rewordConstructionArea {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    min-height: 60px;
    border: 2px dashed #BCAAA4; /* [大地色] */
    padding: 12px;
    gap: 8px;
    margin: 20px auto;
    max-width: 90%;
    background-color: #FAFAFA; /* [大地色] */
    border-radius: 8px;
}

/* 重組提示文字 */
#rewordHint {
    font-size: 24px;
    margin: 20px 10px;
    text-align: center;
    letter-spacing: 3px;
    color: #5D4037; /* [大地色] */
}

/* PC 上放大字體 */
@media (min-width: 601px) {
    #rewordHint {
        font-size: 28px; /* PC 上放大到 28px */
    }
}

.word-block-placeholder {
    display: inline-block;
    margin: 5px;
    min-width: 60px; /* 根據單字長度調整 */
    min-height: 30px; /* 確保空位有高度 */
    border: 1px dashed #BCAAA4; /* [大地色] */
    vertical-align: middle;
}

.word-block-placeholder.empty {
    background-color: #FAFAFA; /* [大地色] */
}

.word-block {
    display: inline-block;
    padding: 5px 10px;
    /* background-color: #e0e0e0; (已在上方 .word-block 統一定義) */
    border-radius: 5px;
    cursor: pointer;
}

/* 構建區域的占位符樣式 */
.construction-placeholder {
    display: inline-block;
    min-width: 60px; /* 根據單字長度調整 */
    min-height: 30px; /* 確保空間可見 */
    margin: 5px;
    border: 1px dashed #BCAAA4; /* [大地色] 虛線邊框提示空間 */
}

.construction-placeholder:empty {
    background-color: #FAFAFA; /* [大地色] 空的占位符顯示灰色背景 */
}

.phonetic-explanation {
    margin-top: 10px;
    border-top: 1px solid #EFEBE9; /* [大地色] */
}

.phonetic-explanation p {
    font-size: 0.8em;
    color: #5D4037; /* [大地色] */
}

/* 新增：分類標題樣式 */
.category-title {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    color: #5D4037; /* [大地色] */
    margin: 10px 0;
}

/* ==========================================
   ✨ 載入器與提示框 (Loader & Toast)
========================================== */

/* 載入中遮罩 */
#loadingOverlay {
    position: fixed; /* 固定在畫面上 */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.75); /* [大地色] 統一樣式 */
    display: flex; /* 使用 Flexbox 來置中 */
    justify-content: center;
    align-items: center;
    z-index: 9999; /* 確保在最上層 */
    transition: opacity 0.5s ease; /* 淡出動畫 */
}

/* 載入中旋轉圖示 (Spinner) */
.spinner {
    width: 60px;
    height: 60px;
    border: 8px solid #f3f3f3; /* 淺灰色軌道 */
    border-top: 8px solid #A1887F; /* [大地色] 旋轉部分 */
    border-radius: 50%;
    animation: spin 1.5s linear infinite; /* 旋轉動畫 */
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* --- 提示框 (Toast Notification) --- */
#toastNotification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 25px;
    border-radius: 8px;
    color: white;
    font-size: 16px;
    z-index: 10000; /* 比遮罩更高 */
    visibility: hidden; /* 預設隱藏 */
    opacity: 0;
    transform: translateY(-50px); /* 從上方滑入 */
    transition: all 0.5s ease-in-out;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

/* 顯示提示框時的樣式 */
#toastNotification.show {
    visibility: visible;
    opacity: 1;
    transform: translateY(0);
}

/* 成功狀態的樣式 (綠色) */
#toastNotification.success {
    background-color: #AED581; /* [大地色] 成功綠 */
}

/* 錯誤狀態的樣式 (紅色) */
#toastNotification.error {
    background-color: #EF9A9A; /* [大地色] 錯誤紅 */
}

/* --- 新增：次分類按鈕樣式 --- */
.subcategory-wrapper .category-button {
    background-color: #fff; /* [大地色] */
    border-color: #ccc; /* [大地色] */
    color: #555; /* [大地色] */
}

.subcategory-wrapper .category-button:hover {
    background-color: #f0f0f0; /* [大地色] */
}

/* 當次分類按鈕被選中時，恢復為藍色高亮 */
.subcategory-wrapper .category-button.selected {
    background: #A1887F; /* [大地色] */
    border-color: #A1887F; /* [大地色] */
    color: #fff;
}